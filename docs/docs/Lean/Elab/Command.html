<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.Command</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.Command";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span></h2><form action="https://google.com/search" method="get" id="search_form"><input type="hidden" name="sitesearch" value="https://leanprover-community.github.io/mathlib4_docs"></input><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button><button>Google site search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/Elab/Binders.html">Lean.Elab.Binders</a></li><li><a href="../.././Lean/Elab/SetOption.html">Lean.Elab.SetOption</a></li><li><a href="../.././Lean/Elab/SyntheticMVars.html">Lean.Elab.SyntheticMVars</a></li><li><a href="../.././Lean/Language/Basic.html">Lean.Language.Basic</a></li><li><a href="../.././Lean/Meta/Diagnostics.html">Lean.Meta.Diagnostics</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.Command" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.Scope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Scope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instInhabitedScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instNonemptyState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instNonemptyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.CommandElabCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabCoreM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.CommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.CommandElab"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElab</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.Linter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Linter</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.tryCatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">tryCatch</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadExceptOfExceptionCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.lintersRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">lintersRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.addLinter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addLinter</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadInfoTreeCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadInfoTreeCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadEnvCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEnvCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadOptionsCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadOptionsCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instAddMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddMessageContextCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadRefCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRefCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadTraceCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadTraceCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddErrorMessageContextCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkMessageAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkMessageAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftCoreM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftIO"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftIO</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadLiftTIOCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLiftTIOCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadResolveNameCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadResolveNameCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadLogCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLogCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.runLinters"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLinters</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getCurrMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getCurrMacroScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getMainModule"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getMainModule</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withFreshMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withFreshMacroScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadQuotationCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadQuotationCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkCommandElabAttributeUnsafe"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkCommandElabAttributeUnsafe</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkCommandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkCommandElabAttribute</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.commandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">commandElabAttribute</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withoutCommandIncrementality"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withoutCommandIncrementality</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withMacroExpansion"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withMacroExpansion</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadMacroAdapterCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadRecDepthCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRecDepthCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.MacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">MacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instTypeNameMacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instToSnapshotTreeMacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.elabCommand"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommand</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.showPartialSyntaxErrors"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">showPartialSyntaxErrors</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.elabCommandTopLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommandTopLevel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.adaptExpander"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">adaptExpander</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instInhabitedCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getBracketedBinderIds"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getBracketedBinderIds</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftTermElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.runTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runTermElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withLoggingExceptions"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withLoggingExceptions</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getScopes"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScopes</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.modifyScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">modifyScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getLevelNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getLevelNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.addUnivLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addUnivLevel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.expandDeclId"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">expandDeclId</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.liftCommandElabM"><span class="name">Lean</span>.<span class="name">liftCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.withSetOptionIn"><span class="name">Lean</span>.<span class="name">withSetOptionIn</span></a></div></nav><main>
<div class="decl" id="Lean.Elab.Command.Scope"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L24-L76">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Scope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Scope</a></code> records the part of the <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> state that respects scoping,
such as the data for <code>universe</code>, <code>open</code>, and <code>variable</code> declarations, the current namespace,
and currently enabled options.
The <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> state contains a stack of scopes, and only the top <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Scope</a></code>
on the stack is read from or modified. There is always at least one <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Scope</a></code> on the stack,
even outside any <code>section</code> or <code>namespace</code>, and each new pushed <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Scope</a></code>
starts as a modified copy of the previous top scope.</p><ul class="structure_fields" id="Lean.Elab.Command.Scope.mk"><li id="Lean.Elab.Command.Scope.header" class="structure_field"><div class="structure_field_info">header : <a href="../.././Init/Prelude.html#String">String</a></div><div class="structure_field_doc"><p>The component of the <code>namespace</code> or <code>section</code> that this scope is associated to.
For example, <code>section a.b.c</code> and <code>namespace a.b.c</code> each create three scopes with headers
named <code>a</code>, <code>b</code>, and <code>c</code>.
This is used for checking the <code>end</code> command. The &quot;base scope&quot; has <code>&quot;&quot;</code> as its header.</p></div></li><li id="Lean.Elab.Command.Scope.opts" class="structure_field"><div class="structure_field_info">opts : <a href="../.././Lean/Data/Options.html#Lean.Options">Lean.Options</a></div><div class="structure_field_doc"><p>The current state of all set options at this point in the scope. Note that this is the
full current set of options and does <em>not</em> simply contain the options set
while this scope has been active.</p></div></li><li id="Lean.Elab.Command.Scope.currNamespace" class="structure_field"><div class="structure_field_info">currNamespace : <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></div><div class="structure_field_doc"><p>The current namespace. The top-level namespace is represented by <code>Name.anonymous</code>.</p></div></li><li id="Lean.Elab.Command.Scope.openDecls" class="structure_field"><div class="structure_field_info">openDecls : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Data/OpenDecl.html#Lean.OpenDecl">Lean.OpenDecl</a></span></div><div class="structure_field_doc"><p>All currently <code>open</code>ed namespaces and names.</p></div></li><li id="Lean.Elab.Command.Scope.levelNames" class="structure_field"><div class="structure_field_info">levelNames : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p>The current list of names for universe level variables to use for new declarations. This is managed by the <code>universe</code> command.</p></div></li><li id="Lean.Elab.Command.Scope.varDecls" class="structure_field"><div class="structure_field_info">varDecls : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.TSyntax">Lean.TSyntax</a> <span class="fn">`Lean.Parser.Term.bracketedBinder</span>)</span></span></div><div class="structure_field_doc"><p>The current list of binders to use for new declarations.
This is managed by the <code>variable</code> command.
Each binder is represented in <code>Syntax</code> form, and it is re-elaborated
within each command that uses this information.</p><p>This is also used by commands, such as <code>#check</code>, to create an initial local context,
even if they do not work with binders per se.</p></div></li><li id="Lean.Elab.Command.Scope.varUIds" class="structure_field"><div class="structure_field_info">varUIds : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p>Globally unique internal identifiers for the <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope.varDecls">varDecls</a></code>.
There is one identifier per variable introduced by the binders
(recall that a binder such as <code>(a b c : Ty)</code> can produce more than one variable),
and each identifier is the user-provided variable name with a macro scope.
This is used by <code>TermElabM</code> in <code><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.Context">Lean.Elab.Term.Context</a></code> to help with processing macros
that capture these variables.</p></div></li><li id="Lean.Elab.Command.Scope.includedVars" class="structure_field"><div class="structure_field_info">includedVars : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p><code>include</code>d section variable names (from <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope.varUIds">varUIds</a></code>)</p></div></li><li id="Lean.Elab.Command.Scope.omittedVars" class="structure_field"><div class="structure_field_info">omittedVars : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p><code>omit</code>ted section variable names (from <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope.varUIds">varUIds</a></code>)</p></div></li><li id="Lean.Elab.Command.Scope.isNoncomputable" class="structure_field"><div class="structure_field_info">isNoncomputable : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If true (default: false), all declarations that fail to compile
automatically receive the <code>noncomputable</code> modifier.
A scope with this flag set is created by <code>noncomputable section</code>.</p><p>Recall that a new scope inherits all values from its parent scope,
so all sections and namespaces nested within a <code>noncomputable</code> section also have this flag set.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Command.Scope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instInhabitedScope"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L76-L76">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instInhabitedScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedScope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L78-L87">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.State.mk"><li id="Lean.Elab.Command.State.env" class="structure_field"><div class="structure_field_info">env : <a href="../.././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></li><li id="Lean.Elab.Command.State.messages" class="structure_field"><div class="structure_field_info">messages : <a href="../.././Lean/Message.html#Lean.MessageLog">Lean.MessageLog</a></div></li><li id="Lean.Elab.Command.State.scopes" class="structure_field"><div class="structure_field_info">scopes : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a></span></div></li><li id="Lean.Elab.Command.State.nextMacroScope" class="structure_field"><div class="structure_field_info">nextMacroScope : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.State.maxRecDepth" class="structure_field"><div class="structure_field_info">maxRecDepth : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.State.ngen" class="structure_field"><div class="structure_field_info">ngen : <a href="../.././Init/MetaTypes.html#Lean.NameGenerator">Lean.NameGenerator</a></div></li><li id="Lean.Elab.Command.State.infoState" class="structure_field"><div class="structure_field_info">infoState : <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoState">Lean.Elab.InfoState</a></div></li><li id="Lean.Elab.Command.State.traceState" class="structure_field"><div class="structure_field_info">traceState : <a href="../.././Lean/Util/Trace.html#Lean.TraceState">Lean.TraceState</a></div></li></ul><details id="instances-for-list-Lean.Elab.Command.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instNonemptyState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L87-L87">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instNonemptyState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instNonemptyState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">Lean.Elab.Command.State</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instNonemptyState">Lean.Elab.Command.instNonemptyState</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">⋯</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L89-L115">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.Context.mk"><li id="Lean.Elab.Command.Context.fileName" class="structure_field"><div class="structure_field_info">fileName : <a href="../.././Init/Prelude.html#String">String</a></div></li><li id="Lean.Elab.Command.Context.fileMap" class="structure_field"><div class="structure_field_info">fileMap : <a href="../.././Lean/Data/Position.html#Lean.FileMap">Lean.FileMap</a></div></li><li id="Lean.Elab.Command.Context.currRecDepth" class="structure_field"><div class="structure_field_info">currRecDepth : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.Context.cmdPos" class="structure_field"><div class="structure_field_info">cmdPos : <a href="../.././Init/Prelude.html#String.Pos">String.Pos</a></div></li><li id="Lean.Elab.Command.Context.macroStack" class="structure_field"><div class="structure_field_info">macroStack : <a href="../.././Lean/Elab/Util.html#Lean.Elab.MacroStack">Lean.Elab.MacroStack</a></div></li><li id="Lean.Elab.Command.Context.currMacroScope" class="structure_field"><div class="structure_field_info">currMacroScope : <a href="../.././Init/Prelude.html#Lean.MacroScope">Lean.MacroScope</a></div></li><li id="Lean.Elab.Command.Context.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div></li><li id="Lean.Elab.Command.Context.tacticCache?" class="structure_field"><div class="structure_field_info">tacticCache? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <a href="../.././Lean/Elab/Term.html#Lean.Elab.Tactic.Cache">Lean.Elab.Tactic.Cache</a>)</span></span></div></li><li id="Lean.Elab.Command.Context.snap?" class="structure_field"><div class="structure_field_info">snap? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotBundle">Lean.Language.SnapshotBundle</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.DynamicSnapshot">Lean.Language.DynamicSnapshot</a>)</span></span></div><div class="structure_field_doc"><p>Snapshot for incremental reuse and reporting of command elaboration. Currently only used for
(mutual) defs and contained tactics, in which case the <code>DynamicSnapshot</code> is a
<code>HeadersParsedSnapshot</code>.</p><p>Definitely resolved in <code>Language.Lean.process.doElab</code>.</p><p>Invariant: if the bundle's <code>old?</code> is set, the context and state at the beginning of current and
old elaboration are identical.</p></div></li><li id="Lean.Elab.Command.Context.cancelTk?" class="structure_field"><div class="structure_field_info">cancelTk? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/System/IO.html#IO.CancelToken">IO.CancelToken</a></span></div><div class="structure_field_doc"><p>Cancellation token forwarded to <code>Core.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.cancelTk?">cancelTk?</a></code>.</p></div></li><li id="Lean.Elab.Command.Context.suppressElabErrors" class="structure_field"><div class="structure_field_info">suppressElabErrors : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If set (when <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.showPartialSyntaxErrors">showPartialSyntaxErrors</a></code> is not set and parsing failed), suppresses most elaboration
errors; see also <code>logMessage</code> below.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Command.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.CommandElabCoreM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L117-L117">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabCoreM</span></a></span><span class="decl_args">
<span class="fn">(ε : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabCoreM">Lean.Elab.Command.CommandElabCoreM</a> <span class="fn">ε</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context">Lean.Elab.Command.Context</a> <span class="fn">(<a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">Lean.Elab.Command.State</a> <span class="fn">(<a href="../.././Init/System/IO.html#EIO">EIO</a> <span class="fn">ε</span>)</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.CommandElabCoreM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.CommandElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L118-L118">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabM</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabCoreM">Lean.Elab.Command.CommandElabCoreM</a> <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.CommandElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.CommandElab"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L119-L119">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElab</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.CommandElab" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.Linter"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L120-L122">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Linter</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.Linter.mk"><li id="Lean.Elab.Command.Linter.run" class="structure_field"><div class="structure_field_info">run : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span></div></li><li id="Lean.Elab.Command.Linter.name" class="structure_field"><div class="structure_field_info">name : <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></div></li></ul><details id="instances-for-list-Lean.Elab.Command.Linter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L131-L131">source</a></div><div class="attributes">@[always_inline]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadCommandElabM">Lean.Elab.Command.instMonadCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">let <span class="fn">i</span> := <span class="fn"><a href="../.././Init/Prelude.html#inferInstanceAs">inferInstanceAs</a> <span class="fn">(<a href="../.././Init/Prelude.html#Monad">Monad</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a>)</span></span>;
  <span class="fn">Monad.mk</span></span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.tryCatch"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L137-L145">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.tryCatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">tryCatch</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(h : <span class="fn"><a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><p>Like <code>Core.tryCatchRuntimeEx</code>; runtime errors are generally used to abort term elaboration, so we do
want to catch and process them at the command level.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.tryCatch">Lean.Elab.Command.tryCatch</a> <span class="fn">x</span> <span class="fn">h</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.tryCatch">tryCatch</a> <span class="fn">x</span> <span class="fn">fun (<span class="fn">ex</span> : <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a>) =&gt; <span class="fn">if <span class="fn"><span class="fn"><span class="fn">ex</span>.isInterrupt</span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> then <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a> <span class="fn">ex</span></span> else <span class="fn"><span class="fn">h</span> <span class="fn">ex</span></span></span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.tryCatch" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L147-L149">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadExceptOfExceptionCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadExceptOf">MonadExceptOf</a> <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM">Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">throw</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <span class="fn">throw</span></span>, <span class="fn">tryCatch</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <span class="fn">Lean.Elab.Command.tryCatch</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L151-L156">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkState</span></a></span><span class="decl_args">
<span class="fn">(env : <a href="../.././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(messages : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> <a href="../.././Lean/Message.html#Lean.MessageLog">Lean.MessageLog</a>
  <span class="fn">{ <span class="fn">hadErrors</span> := <a href="../.././Init/Prelude.html#Bool.false">false</a>,
    <span class="fn">unreported</span> :=
      <span class="fn">{ <span class="fn">root</span> := <span class="fn"><a href="../.././Lean/Data/PersistentArray.html#Lean.PersistentArrayNode.node">Lean.PersistentArrayNode.node</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array.mkEmpty">Array.mkEmpty</a> <span class="fn"><a href="../.././Lean/Data/PersistentArray.html#Lean.PersistentArray.branching">Lean.PersistentArray.branching</a>.toNat</span>)</span></span>,
        <span class="fn">tail</span> := <span class="fn"><a href="../.././Init/Prelude.html#Array.mkEmpty">Array.mkEmpty</a> <span class="fn"><a href="../.././Lean/Data/PersistentArray.html#Lean.PersistentArray.branching">Lean.PersistentArray.branching</a>.toNat</span></span>, <span class="fn">size</span> := <span class="fn">0</span>, <span class="fn">shift</span> := <a href="../.././Lean/Data/PersistentArray.html#Lean.PersistentArray.initShift">Lean.PersistentArray.initShift</a>,
        <span class="fn">tailOff</span> := <span class="fn">0</span> }</span>,
    <span class="fn">reportedKinds</span> := <a href="../.././Init/Core.html#EmptyCollection.emptyCollection">∅</a> }</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> <a href="../.././Lean/Data/Options.html#Lean.Options">Lean.Options</a> <span class="fn">{ <span class="fn">entries</span> := <span class="fn">[]</span> }</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">Lean.Elab.Command.State</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkState" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.lintersRef"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L160-L160">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">lintersRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter">Lean.Linter</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.addLinter"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L163-L165">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addLinter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addLinter</span></a></span><span class="decl_args">
<span class="fn">(l : <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter">Lean.Linter</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addLinter">Lean.addLinter</a> <span class="fn">l</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ls</span> ← <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.get">ST.Ref.get</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef">Lean.Elab.Command.lintersRef</a></span>
  <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.set">ST.Ref.set</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef">Lean.Elab.Command.lintersRef</a> <span class="fn">(<span class="fn"><span class="fn">ls</span>.push</span> <span class="fn">l</span>)</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.addLinter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadInfoTreeCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L167-L169">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadInfoTreeCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadInfoTreeCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.MonadInfoTree">Lean.Elab.MonadInfoTree</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadEnvCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L171-L173">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadEnvCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEnvCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadOptionsCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L176-L177">source</a></div><div class="attributes">@[always_inline]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadOptionsCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadOptionsCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/Options.html#Lean.MonadOptions">Lean.MonadOptions</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadOptionsCommandElabM">Lean.Elab.Command.instMonadOptionsCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{
    <span class="fn">getOptions</span> := <span class="fn">do
      let <span class="fn">__do_lift</span> ← <span class="fn">get</span>
      <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn"><span class="fn"><span class="fn">__do_lift</span>.scopes</span>.head!</span>.opts</span></span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getRef"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L179-L180">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getRef">Lean.Elab.Command.getRef</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">read</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.ref</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instAddMessageContextCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L182-L183">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddMessageContextCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Message.html#Lean.AddMessageContext">Lean.AddMessageContext</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddMessageContextCommandElabM">Lean.Elab.Command.instAddMessageContextCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">addMessageContext</span> := <span class="fn">Lean.addMessageContextPartial</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadRefCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L185-L187">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadRefCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRefCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadRef">Lean.MonadRef</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadTraceCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L189-L191">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadTraceCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadTraceCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Util/Trace.html#Lean.MonadTrace">Lean.MonadTrace</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L193-L199">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddErrorMessageContextCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Exception.html#Lean.AddErrorMessageContext">Lean.AddErrorMessageContext</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkMessageAux"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L201-L204">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkMessageAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkMessageAux</span></a></span><span class="decl_args">
<span class="fn">(ctx : <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context">Lean.Elab.Command.Context</a>)</span></span>
<span class="decl_args">
<span class="fn">(ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(msgData : <a href="../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a>)</span></span>
<span class="decl_args">
<span class="fn">(severity : <a href="../.././Lean/Message.html#Lean.MessageSeverity">Lean.MessageSeverity</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Message.html#Lean.Message">Lean.Message</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkMessageAux" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftCoreM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L268-L269">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftCoreM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/CoreM.html#Lean.Core.CoreM">Lean.CoreM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftCoreM">Lean.Elab.Command.liftCoreM</a> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Lean/Elab/Command.html#_private.Lean.Elab.Command.0.Lean.Elab.Command.runCore">Lean.Elab.Command.runCore</a> <span class="fn">(<a href="../.././Init/Control/Except.html#observing">observing</a> <span class="fn">x</span>)</span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.ofExcept">ofExcept</a> <span class="fn">__do_lift</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftCoreM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftIO"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L275-L277">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftIO"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftIO</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftIO">Lean.Elab.Command.liftIO</a> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <span class="fn">read</span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a>
      <span class="fn">(<a href="../.././Init/System/IO.html#IO.toEIO">IO.toEIO</a>
        <span class="fn">(fun (<span class="fn">ex</span> : <a href="../.././Init/System/IOError.html#IO.Error">IO.Error</a>) =&gt; <span class="fn"><a href="../.././Lean/Exception.html#Lean.Exception.error">Lean.Exception.error</a> <span class="fn"><span class="fn">ctx</span>.ref</span> <span class="fn">(<span class="fn">(<a href="../.././Lean/Message.html#Lean.MessageData.ofFormat">Lean.MessageData.ofFormat</a> <a href="../.././Init/Prelude.html#Function.comp">∘</a> <span class="fn">Std.format</span>)</span> <span class="fn"><span class="fn">ex</span>.toString</span>)</span></span>)</span> <span class="fn">x</span>)</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftIO" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadLiftTIOCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L279-L280">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLiftTIOCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLiftTIOCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadLiftT">MonadLiftT</a> <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLiftTIOCommandElabM">Lean.Elab.Command.instMonadLiftTIOCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">monadLift</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <span class="fn">Lean.Elab.Command.liftIO</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L283-L283">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a></span></div></div><p>Return the current scope.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope">Lean.Elab.Command.getScope</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">get</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn"><span class="fn">__do_lift</span>.scopes</span>.head!</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadResolveNameCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L285-L287">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadResolveNameCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadResolveNameCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/ResolveName.html#Lean.MonadResolveName">Lean.MonadResolveName</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadLogCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L289-L303">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLogCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLogCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Log.html#Lean.MonadLog">Lean.MonadLog</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.runLinters"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L305-L319">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runLinters"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLinters</span></a></span><span class="decl_args">
<span class="fn">(stx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.runLinters" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getCurrMacroScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L321-L321">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getCurrMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getCurrMacroScope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Nat">Nat</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getCurrMacroScope">Lean.Elab.Command.getCurrMacroScope</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">read</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.currMacroScope</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getCurrMacroScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getMainModule"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L322-L322">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getMainModule"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getMainModule</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getMainModule">Lean.Elab.Command.getMainModule</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">Lean.getEnv</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.mainModule</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getMainModule" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withFreshMacroScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L324-L326">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withFreshMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withFreshMacroScope</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withFreshMacroScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadQuotationCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L328-L331">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadQuotationCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadQuotationCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadQuotation">Lean.MonadQuotation</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkCommandElabAttributeUnsafe"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L333-L334">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkCommandElabAttributeUnsafe"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkCommandElabAttributeUnsafe</span></a></span><span class="decl_args">
<span class="fn">(ref : <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">(<a href="../.././Lean/KeyedDeclsAttribute.html#Lean.KeyedDeclsAttribute">Lean.KeyedDeclsAttribute</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkCommandElabAttributeUnsafe" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkCommandElabAttribute"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L337-L337">source</a></div><div class="attributes">@[implemented_by Lean.Elab.Command.mkCommandElabAttributeUnsafe]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkCommandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkCommandElabAttribute</span></a></span><span class="decl_args">
<span class="fn">(ref : <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">(<a href="../.././Lean/KeyedDeclsAttribute.html#Lean.KeyedDeclsAttribute">Lean.KeyedDeclsAttribute</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.commandElabAttribute"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L339-L339">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.commandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">commandElabAttribute</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/KeyedDeclsAttribute.html#Lean.KeyedDeclsAttribute">Lean.KeyedDeclsAttribute</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.withoutCommandIncrementality"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L356-L363">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withoutCommandIncrementality"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withoutCommandIncrementality</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(cond : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(act : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><p>Disables incremental command reuse <em>and</em> reporting for <code>act</code> if <code><a href="../.././Init/Prelude.html#cond">cond</a></code> is true by setting
<code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.snap?">Context.snap?</a></code> to <code>none</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withoutCommandIncrementality" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withMacroExpansion"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L378-L380">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withMacroExpansion"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withMacroExpansion</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(beforeStx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(afterStx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><p>Elaborate <code>x</code> with <code>stx</code> on the macro stack</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withMacroExpansion" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L382-L385">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadMacroAdapterCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Util.html#Lean.Elab.MonadMacroAdapter">Lean.Elab.MonadMacroAdapter</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadRecDepthCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L387-L390">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadRecDepthCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRecDepthCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Exception.html#Lean.MonadRecDepth">Lean.MonadRecDepth</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.MacroExpandedSnapshot"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L396-L409">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">MacroExpandedSnapshot</span></a></span><span class="decl_extends">extends</span><span class="decl_parent">
<span class="fn"><a class="break_within" href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">Snapshot</span></a></span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Snapshot after macro expansion of a command.</p><ul class="structure_fields" id="Lean.Elab.Command.MacroExpandedSnapshot.mk"><li id="Lean.Elab.Command.MacroExpandedSnapshot.desc" class="structure_field"><div class="structure_field_info">desc : <a href="../.././Init/Prelude.html#String">String</a></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.diagnostics" class="structure_field"><div class="structure_field_info">diagnostics : <a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.Diagnostics">Lean.Language.Snapshot.Diagnostics</a></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.infoTree?" class="structure_field"><div class="structure_field_info">infoTree? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoTree">Lean.Elab.InfoTree</a></span></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.isFatal" class="structure_field"><div class="structure_field_info">isFatal : <a href="../.././Init/Prelude.html#Bool">Bool</a></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.macroDecl" class="structure_field"><div class="structure_field_info">macroDecl : <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a></div><div class="structure_field_doc"><p>The declaration name of the macro.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.newStx" class="structure_field"><div class="structure_field_info">newStx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div><div class="structure_field_doc"><p>The expanded syntax tree.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.newNextMacroScope" class="structure_field"><div class="structure_field_info">newNextMacroScope : <a href="../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p><code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State.nextMacroScope">State.nextMacroScope</a></code> after expansion.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.hasTraces" class="structure_field"><div class="structure_field_info">hasTraces : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Whether any traces were present after expansion.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.next" class="structure_field"><div class="structure_field_info">next : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTask">Lean.Language.SnapshotTask</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.DynamicSnapshot">Lean.Language.DynamicSnapshot</a>)</span></span></div><div class="structure_field_doc"><p>Follow-up elaboration snapshots, one per command if <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot.newStx">newStx</a></code> is a sequence of commands.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Command.MacroExpandedSnapshot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L409-L409">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instTypeNameMacroExpandedSnapshot</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Dynamic.html#TypeName">TypeName</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot">Lean.Elab.Command.MacroExpandedSnapshot</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot">Lean.Elab.Command.instTypeNameMacroExpandedSnapshot</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.inst._@.Lean.Elab.Command._hyg.3440">Lean.Elab.Command.inst✝</a></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L411-L412">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instToSnapshotTreeMacroExpandedSnapshot</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Language/Basic.html#Lean.Language.ToSnapshotTree">Lean.Language.ToSnapshotTree</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot">Lean.Elab.Command.MacroExpandedSnapshot</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.elabCommand"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L414-L491">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommand</span></a></span><span class="decl_args">
<span class="fn">(stx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.showPartialSyntaxErrors"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L495-L499">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.showPartialSyntaxErrors"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">showPartialSyntaxErrors</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/Options.html#Lean.Option">Lean.Option</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Option for showing elaboration errors from partial syntax errors.</p></div></div><div class="decl" id="Lean.Elab.Command.elabCommandTopLevel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L509-L537">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommandTopLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommandTopLevel</span></a></span><span class="decl_args">
<span class="fn">(stx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p><code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand">elabCommand</a></code> wrapper that should be used for the initial invocation, not for recursive calls after
macro expansion etc.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.elabCommandTopLevel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.adaptExpander"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L540-L542">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.adaptExpander"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">adaptExpander</span></a></span><span class="decl_args">
<span class="fn">(exp : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a></div></div><p>Adapt a syntax transformation to a regular, command-producing elaborator.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.adaptExpander">Lean.Elab.Command.adaptExpander</a> <span class="fn">exp</span> <span class="fn">stx</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">stx'</span> ← <span class="fn"><span class="fn">exp</span> <span class="fn">stx</span></span>
  <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withMacroExpansion">Lean.Elab.Command.withMacroExpansion</a> <span class="fn">stx</span> <span class="fn">stx'</span> <span class="fn">(<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand">Lean.Elab.Command.elabCommand</a> <span class="fn">stx'</span>)</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.adaptExpander" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instInhabitedCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L547-L548">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instInhabitedCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedCommandElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">Lean.Elab.Command.instInhabitedCommandElabM</span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a> <span class="fn">default</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getBracketedBinderIds"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L556-L562">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getBracketedBinderIds"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getBracketedBinderIds</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span></span></div></div><p>Return identifier names in the given bracketed binder.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.getBracketedBinderIds" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftTermElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L599-L613">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftTermElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><p>Lift the <code>TermElabM</code> monadic action <code>x</code> into a <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> monadic action.</p><p>Note that <code>x</code> is executed with an empty message log. Thus, <code>x</code> cannot modify/view messages produced by
previous commands.</p><p>If you need to access the free variables corresponding to the ones declared using the <code>variable</code> command,
consider using <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM">runTermElabM</a></code>.</p><p>Recall that <code>TermElabM</code> actions can automatically lift <code>MetaM</code> and <code>CoreM</code> actions.
Example:</p><pre><code>import <a href="../.././Lean.html">Lean</a>

open <a href="../.././Lean.html">Lean</a> Elab Command Meta

def printExpr (e : Expr) : MetaM <a href="../.././Init/Prelude.html#Unit">Unit</a> := do
  <a href="../.././Init/System/IO.html#IO.println">IO.println</a> s!&quot;{← ppExpr e} : {← ppExpr (← inferType e)}&quot;

#eval
  <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">liftTermElabM</a> do
    printExpr (mkConst ``Nat)
</code></pre><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftTermElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.runTermElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L637-L654">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runTermElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(elabFn : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span> → <span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><p>Execute the monadic action <code>elabFn xs</code> as a <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> monadic action, where <code>xs</code> are free variables
corresponding to all active scoped variables declared using the <code>variable</code> command.</p><p>This method is similar to <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">liftTermElabM</a></code>, but it elaborates all scoped variables declared using the <code>variable</code>
command.</p><p>Example:</p><pre><code>import <a href="../.././Lean.html">Lean</a>

open <a href="../.././Lean.html">Lean</a> Elab Command Meta

variable {α : Type u} {f : α → α}
variable (n : Nat)

#eval
  <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM">runTermElabM</a> fun xs =&gt; do
    for x in xs do
      <a href="../.././Init/System/IO.html#IO.println">IO.println</a> s!&quot;{← ppExpr x} : {← ppExpr (← inferType x)}&quot;
</code></pre><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.runTermElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withLoggingExceptions"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L661-L662">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withLoggingExceptions"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withLoggingExceptions</span></a></span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabCoreM">Lean.Elab.Command.CommandElabCoreM</a> <a href="../.././Init/Prelude.html#Empty">Empty</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Catches and logs exceptions occurring in <code>x</code>. Unlike <code>try catch</code> in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code>, this function
catches interrupt exceptions as well and thus is intended for use at the top level of elaboration.
Interrupt and abort exceptions are caught but not logged.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withLoggingExceptions">Lean.Elab.Command.withLoggingExceptions</a> <span class="fn">x</span> <span class="fn">ctx</span> <span class="fn">ref</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Util.html#Lean.Elab.withLogging">Lean.Elab.withLogging</a> <span class="fn">x</span> <span class="fn">ctx</span> <span class="fn">ref</span>)</span>.catchExceptions</span> <span class="fn">fun (<span class="fn">x</span> : <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a>) =&gt; <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#Unit.unit">()</a></span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.withLoggingExceptions" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getScopes"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L672-L673">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScopes"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScopes</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a>)</span></span></div></div><p>Return the stack of all currently active scopes:
the base scope always comes last; new scopes are prepended in the front.
In particular, the current scope is always the first element.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScopes">Lean.Elab.Command.getScopes</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">get</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.scopes</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getScopes" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.modifyScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L675-L680">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.modifyScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">modifyScope</span></a></span><span class="decl_args">
<span class="fn">(f : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a> → <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.modifyScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L682-L690">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withScope</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(f : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a> → <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Scope">Lean.Elab.Command.Scope</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(x : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getLevelNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L692-L693">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getLevelNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getLevelNames</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getLevelNames">Lean.Elab.Command.getLevelNames</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope">Lean.Elab.Command.getScope</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.levelNames</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getLevelNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.addUnivLevel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L695-L701">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addUnivLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addUnivLevel</span></a></span><span class="decl_args">
<span class="fn">(idStx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.addUnivLevel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.expandDeclId"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L703-L710">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.expandDeclId"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">expandDeclId</span></a></span><span class="decl_args">
<span class="fn">(declId : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(modifiers : <a href="../.././Lean/Elab/DeclModifiers.html#Lean.Elab.Modifiers">Lean.Elab.Modifiers</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Lean/Elab/DeclModifiers.html#Lean.Elab.ExpandDeclIdResult">Lean.Elab.ExpandDeclIdResult</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.expandDeclId" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.liftCommandElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L724-L744">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.liftCommandElabM"><span class="name">Lean</span>.<span class="name">liftCommandElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(cmd : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/CoreM.html#Lean.Core.CoreM">Lean.CoreM</a> <span class="fn">α</span></span></div></div><p>Lifts an action in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> into <code>CoreM</code>, updating the traces and the environment.</p><p>Commands that modify the processing of subsequent commands,
such as <code>open</code> and <code>namespace</code> commands,
only have an effect for the remainder of the <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> computation passed here,
and do not affect subsequent commands.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.liftCommandElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.withSetOptionIn"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/ec3042d94bd11a42430f9e14d39e26b1f880f99b/src/Lean/Elab/Command.lean#L750-L757">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.withSetOptionIn"><span class="name">Lean</span>.<span class="name">withSetOptionIn</span></a></span><span class="decl_args">
<span class="fn">(cmd : <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a></div></div><p>Given a command elaborator <code>cmd</code>, returns a new command elaborator that
first evaluates any local <code>set_option ... in ...</code> clauses and then invokes <code>cmd</code> on what remains.</p></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>